<!DOCTYPE html>
<html>
  <head>
    <!-- no puede utiliza este odigo po derechos de autor Giovanni Ernesto rodriguez diaz  -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pintura 3d Gio</title>

    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
    <script src="https://assets.babylonjs.com/generated/Assets.js"></script>
    <script src="https://cdn.babylonjs.com/recast.js"></script>
    <script src="https://cdn.babylonjs.com/ammo.js"></script>
    <script src="https://cdn.babylonjs.com/havok/HavokPhysics_umd.js"></script>
    <script src="https://cdn.babylonjs.com/cannon.js"></script>
    <script src="https://cdn.babylonjs.com/Oimo.js"></script>
    <script src="https://cdn.babylonjs.com/earcut.min.js"></script>
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
    <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
    <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script>
    <script src="https://cdn.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
    <script src="https://cdn.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>

    <style>
      html,
      body {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      #renderCanvas {
        width: 100%;
        height: 100%;
        touch-action: none;
      }

      #canvasZone {
        width: 100%;
        height: 100%;
        z-index: -1;
      }

      #idpaneldecontrol2 {
        position: absolute;
        top: 70%;
        left: 1%;

        width: auto;
        height: 80px;
        background-color: rgb(0, 0, 0);
        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        justify-content: flex-start;
        align-items: flex-start;
        align-content: center;
      }

      #idpaneldecontrol2 * {
        margin-bottom: 1rem;
      }

      #idclickInputfile {
      }

      .displanenoe {
        display: none;
      }

      .clhover:hover {
        color: rgb(27, 145, 255);
        border: 3px solid rgb(27, 145, 255);
      }

      .clcirlce {
        position: relative;
        width: 20px;
        height: 79px;
        border: 3px solid #c7c7c7;
        border-radius: 50%;
        background-color: #000000b9;
        color: #ffffff;

        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        justify-content: center;
        align-items: center;
        align-content: center;

        cursor: pointer;
      }

      .imfMostrar1{
        position: absolute;
        bottom:  0%;
        right: 0%;
        z-index: 1000;
        width: 140px;
        height: 130px;
        background-color: #000000b6;
      }
    </style>
  </head>

  <body>
    <div id="canvasZone"><canvas id="renderCanvas"></canvas></div>

    <div id="idpaneldecontrol2">
      <div
        id="idclickInputfile"
        class="clhover clcirlce"
        onclick="loadInputfilesIDdvv()"
      >
        &#x2681;
      </div>
      <script>
        function loadInputfilesIDdvv() {
          document.getElementById("fileInput").click();
        }
      </script>
      <input
        id="fileInput"
        class="displanenoe"
        type="file"
        accept=".glb, .obj"
      />
      <div
        id="idclickInputTexture"
        class="clhover clcirlce"
        onclick="loadInputfilesIDdvvTexture()"
      >
        &#x268F;
      </div>
      <script>
        function loadInputfilesIDdvvTexture() {
          document.getElementById("textureUploader").click();
        }
      </script>
      <input
        type="file"
        id="textureUploader"
        class="displanenoe"
        accept="image/*"
      />


      <div id="idshlayer"    class="clhover clcirlce" onclick="fclicklayerbabylon()">|=|</div>
      <script>
        var booLayerShow=true;
        function fclicklayerbabylon(){
            if(booLayerShow){

               
BABYLON.Engine.LastCreatedScene.debugLayer.show({ embedMode: true });
            }
            else{

                BABYLON.Engine.LastCreatedScene.debugLayer.hide();
 
            }
            booLayerShow=!booLayerShow;
 
        }
      </script>
    </div>
    <img id="idimggiob" class="imfMostrar1" src="" alt="" />
    <script>
  var color4Image = new Image();
var canvasdetexture = null;
var canvasidMask = null;

var laimagneesCombiandases = async (url1, url2) => {
            await loadAndResizeImage(url1, 1024, 1024);
            await loadAndResizeImageMarsk("./brush.png", 1024, 1024);
            var imagendata1 = gettImagendataGio(canvasdetexture);
            var imagendataMask = gettImagendataGio(canvasidMask);

            let combianrimgedata = combineImageData(
              imagendata1,
              imagendataMask
            );
            let context = canvasdetexture.getContext("2d");
            context.putImageData(combianrimgedata, 0, 0);
            color4Image.src = canvasdetexture.toDataURL("image/png");
          };

          
          function loadAndResizeImage(imageUrl, width = 1024, height = 1024) {
            return new Promise((resolve, reject) => {
              if (!canvasdetexture) {
                canvasdetexture = document.createElement("canvas");
              }

              canvasdetexture.id = "canvasdetexture";
              let context = canvasdetexture.getContext("2d");

              if (!context) {
                reject(
                  new Error("No se pudo obtener el contexto 2D del canvas.")
                );
                return;
              }

              canvasdetexture.width = width;
              canvasdetexture.height = height;

              const image = new Image();
              image.crossOrigin = "Anonymous";

              image.onload = function () {
                context.drawImage(image, 0, 0, width, height);
                resolve(canvasdetexture);
                if (idimggiob) {
                  idimggiob.width = width;
                  idimggiob.height = height;
                  idimggiob.src = canvasdetexture.toDataURL("image/png");
                }
              };

              image.onerror = function () {
                reject(new Error("No se pudo cargar la imagen."));
              };

              image.src = imageUrl;
            });
          }

       
          function loadAndResizeImageMarsk(
            imageUrl,
            width = 1024,
            height = 1024
          ) {

            console.log(imageUrl ,' ruta loadAndResizeImageMarsk');
            return new Promise((resolve, reject) => {
              if (!canvasidMask) {
                canvasidMask = document.createElement("canvas");
              }

              canvasidMask.id = "idMask";
              let context = canvasidMask.getContext("2d");

              if (!context) {
                reject(
                  new Error("No se pudo obtener el contexto 2D del canvas.")
                );
                return;
              }

              canvasidMask.width = width;
              canvasidMask.height = height;

              const image = new Image();
              image.crossOrigin = "Anonymous";

              image.onload = function () {
                context.drawImage(image, 0, 0, width, height);
                resolve(canvasidMask);
              };

              image.onerror = function () {
                reject(new Error("No se pudo cargar la imagen."));
              };

              image.src = "brush.png";
            });
          }

          function gettImagendataGio(canvas) {
            let ctx = canvas.getContext("2d");
            return ctx.getImageData(0, 0, canvas.width, canvas.height);
          }


          function combineImageData(imageData1, imageData2) {
            if (
              imageData1.width !== imageData2.width ||
              imageData1.height !== imageData2.height
            ) {
              throw new Error("Las imágenes deben tener el mismo tamaño.");
            }

            const width = imageData1.width;
            const height = imageData1.height;
            const data1 = imageData1.data;
            const data2 = imageData2.data;

            const combinedImageData = new ImageData(width, height);
            const combinedData = combinedImageData.data;

            for (let i = 0; i < data1.length; i += 4) {
              const r1 = data1[i];
              const g1 = data1[i + 1];
              const b1 = data1[i + 2];
              const a1 = data1[i + 3] / 255;

              const r2 = data2[i];
              const g2 = data2[i + 1];
              const b2 = data2[i + 2];
              const a2 = data2[i + 3] / 255;

              combinedData[i] = r1;
              combinedData[i + 1] = g1;
              combinedData[i + 2] = b1;
              combinedData[i + 3] = r2;
            }

            return combinedImageData;
          }


          function createBrushTextureantes    (color) {
            const brushTexture = new BABYLON.DynamicTexture(
              "brushTexture",
              { width: 50, height: 50 },
              scene
            );
            const brushContext = brushTexture.getContext();
            brushContext.fillStyle = color;
            brushContext.fillRect(0, 0, 50, 50);
            for (let i = 0; i < 500; i++) {
              brushContext.fillStyle = `rgba(255,255,255,${
                Math.random() * 0.2
              })`;
              brushContext.beginPath();
              brushContext.arc(
                Math.random() * 50,
                Math.random() * 50,
                Math.random() * 2,
                0,
                Math.PI * 2
              );
              brushContext.fill();
            }
            brushTexture.update();
            return brushTexture;
          }
          function crearimgIni   (color, scene=BABYLON.Engine.LastCreatedScene) {
            let brushTexture = new BABYLON.DynamicTexture(
              "brushTexture",
              { width: 50, height: 50 },
              scene
            );
            console.log(brushTexture,'brushTexture');
            let brushContext = brushTexture.getContext();
            console.log(brushContext,' brushContext');
            brushContext.fillStyle = color;
            brushContext.fillRect(0, 0, 50, 50);
            for (let i = 0; i < 500; i++) {
              brushContext.fillStyle = `rgba(255,255,255,${
                Math.random() * 0.2
              })`;
              brushContext.beginPath();
              brushContext.arc(
                Math.random() * 50,
                Math.random() * 50,
                Math.random() * 2,
                0,
                Math.PI * 2
              );
              brushContext.fill();
            }
            brushTexture.update();
            return brushTexture;
          }


          var brushTextures = null;


          color4Image.onload = function (scene=BABYLON.Engine.LastCreatedScene) {
            console.log(scene,'scene load');
            const color4Texture = new BABYLON.DynamicTexture(
              "color4Texture",
              { width: 50, height: 50 },
              BABYLON.Engine.LastCreatedScene/// scene
            );
            const color4Context = color4Texture.getContext();
            color4Context.drawImage(color4Image, 0, 0, 50, 50);
            color4Texture.update();
            brushTextures.color4 = color4Texture;
          };






       




          //---------------------------



      let brushSize = 300;
      let brushRotation = 0;
      var SceneLoader = BABYLON.SceneLoader;
      var canvas = document.getElementById("renderCanvas");
//------ 

const _0x15bb99=_0x530a;function _0x528e(){const _0x31af5e=['onValueChangedObservable','canvas','PositionKind','cubeMaterial','cube','CreateFullscreenUI','Slider','dynamic\x20texture','10px','random','result','material','UVs\x20adjusted\x20and\x20applied.','MeshBuilder','TextBlock','fileInput','fill','textureUploader','button','blue','fillRect','pointerY','green','Button','createDefaultSkybox','VertexBuffer','floor','forEach','add','scene','type','attachControl','then','4609048oHYokM','953588lljkZq','Bloquear\x20rotación','render','Tamaño\x20de\x20brocha:\x20','width','file','color1','Checkbox','white','CubeTexture','hit','onPointerUpObservable','-90px','Vector3','readAsDataURL','CreateSimpleButton','getRenderingCanvas','rgba(0,\x200,\x200,\x200.5)','rgba(255,255,255,','red','round','getImageData','color','FromArray','20px','40px','value','-60px','change','CreateFromPrefilteredData','data','Color\x204','src','Rotación\x20de\x20brocha:\x20','Control','horizontalAlignment','detachControl','left','accept','./brush.png','apintarB.png','target','meshes','runRenderLoop','log','Engine','-120px','11044242HoDVPm','materials','12fZoSyO','Dot','subtract','skyBox','slice','StandardMaterial','cos','putImageData','height','5857hGTEiL','.glb,\x20.obj','AppendAsync','isChecked','117183bmSXcQ','getVerticesData','createDefaultCameraOrLight','1533945Uoasrt','warn','setVerticesData','DynamicTexture','name','UVKind','sin','engine\x20should\x20not\x20be\x20null.',',\x20V:\x20','pick','clone','drawImage','Tamaño\x20de\x20brocha:\x2050','addControl','brushTexture','Rotación\x20de\x20brocha:\x200°','textures/environment.dds','onload','UV\x20Scale\x20-\x20U:\x20','PBRMaterial','text','map','HORIZONTAL_ALIGNMENT_LEFT','446ROQmsg','200px','VERTICAL_ALIGNMENT_BOTTOM','No\x20UV\x20data\x20found\x20for\x20the\x20mesh.','AdvancedDynamicTexture','arc','220px','top','SceneLoader','dispose','pickedMesh','fillStyle','verticalAlignment','addEventListener','pickedPoint','589806oDCNei','initFunction','albedoTexture','metallic','CreateScene','getTextureCoordinates','diffuseTexture','MAX_VALUE','GUI','currentBrush','pointerX','420MsHAmR','hdrSkyBox','7lfoOLo','length','files','roughness','resize','getContext','update','the\x20available\x20createEngine\x20function\x20failed.\x20Creating\x20the\x20default\x20engine\x20instead','getElementById','pbrMaterial'];_0x528e=function(){return _0x31af5e;};return _0x528e();}(function(_0xb61744,_0x1f6e1f){const _0x58ccd1=_0x530a,_0x794a89=_0xb61744();while(!![]){try{const _0x40e5ab=-parseInt(_0x58ccd1(0x15a))/0x1*(-parseInt(_0x58ccd1(0x178))/0x2)+-parseInt(_0x58ccd1(0x151))/0x3*(-parseInt(_0x58ccd1(0x120))/0x4)+-parseInt(_0x58ccd1(0x161))/0x5+parseInt(_0x58ccd1(0xe7))/0x6+parseInt(_0x58ccd1(0xf4))/0x7*(-parseInt(_0x58ccd1(0x11f))/0x8)+-parseInt(_0x58ccd1(0x14f))/0x9+-parseInt(_0x58ccd1(0xf2))/0xa*(-parseInt(_0x58ccd1(0x15e))/0xb);if(_0x40e5ab===_0x1f6e1f)break;else _0x794a89['push'](_0x794a89['shift']());}catch(_0x3f5b98){_0x794a89['push'](_0x794a89['shift']());}}}(_0x528e,0xa9c48));var startRenderLoop=function(_0x2540cf,_0x55f65a){const _0x3068ba=_0x530a;_0x2540cf[_0x3068ba(0x14b)](function(){const _0x32ec62=_0x3068ba;sceneToRender&&sceneToRender['activeCamera']&&sceneToRender[_0x32ec62(0x122)]();});},engine=null,scene=null,sceneToRender=null,createDefaultEngine=function(){const _0x4c3cf8=_0x530a;return new BABYLON[(_0x4c3cf8(0x14d))](canvas,!![],{'preserveDrawingBuffer':!![],'stencil':!![],'disableWebGL2Support':![]});};function _0x530a(_0x197f7f,_0x3d55b7){const _0x528e8a=_0x528e();return _0x530a=function(_0x530ab1,_0x4d5294){_0x530ab1=_0x530ab1-0xdd;let _0x742dc4=_0x528e8a[_0x530ab1];return _0x742dc4;},_0x530a(_0x197f7f,_0x3d55b7);}class Playground{static async[_0x15bb99(0xeb)](_0x13390c){const _0x53b1a4=_0x15bb99,_0x537551=new BABYLON['Scene'](_0x13390c);brushTextures={'color1':crearimgIni(_0x53b1a4(0x133)),'color2':crearimgIni(_0x53b1a4(0x111)),'color3':crearimgIni(_0x53b1a4(0x114)),'color4':null};const _0x20ad39=BABYLON[_0x53b1a4(0x129)][_0x53b1a4(0x13d)](_0x53b1a4(0x171),_0x537551),_0x6f5111=_0x537551[_0x53b1a4(0x116)](_0x20ad39,!![]),_0x328503=BABYLON[_0x53b1a4(0x10b)]['CreateBox'](_0x53b1a4(0x102),{'size':0x1},_0x537551);let _0x4dd466=0x400,_0x2a260e=new BABYLON[(_0x53b1a4(0x164))](_0x53b1a4(0x105),{'width':_0x4dd466,'height':_0x4dd466},_0x537551),_0x243e6d=_0x2a260e[_0x53b1a4(0xf9)]();_0x243e6d[_0x53b1a4(0xe3)]='white',_0x243e6d[_0x53b1a4(0x112)](0x0,0x0,_0x4dd466,_0x4dd466),_0x2a260e[_0x53b1a4(0xfa)]();let _0x3fa2d9=new BABYLON[(_0x53b1a4(0x156))](_0x53b1a4(0x101),_0x537551);_0x3fa2d9[_0x53b1a4(0xed)]=_0x2a260e,_0x328503[_0x53b1a4(0x109)]=_0x3fa2d9;const _0xb2b6=function(_0xacd825,_0x1ac4de=null){return new Promise(_0x5d6e41=>{const _0x349ebc=_0x530a,_0x37fc00=new BABYLON[(_0x349ebc(0x164))](_0x349ebc(0x16f),{'width':0x32,'height':0x32},_0x537551),_0x3a0608=_0x37fc00[_0x349ebc(0xf9)]();if(_0x1ac4de){const _0x17e80b=new Image();_0x17e80b[_0x349ebc(0x172)]=function(){const _0x2ec337=_0x349ebc;_0x3a0608[_0x2ec337(0x16c)](_0x17e80b,0x0,0x0,0x32,0x32),_0x37fc00['update'](),_0x5d6e41(_0x37fc00);},_0x17e80b[_0x349ebc(0x140)]=_0x1ac4de;}else{_0x3a0608[_0x349ebc(0xe3)]=_0xacd825,_0x3a0608[_0x349ebc(0x112)](0x0,0x0,0x32,0x32);for(let _0x23e26c=0x0;_0x23e26c<0x1f4;_0x23e26c++){_0x3a0608[_0x349ebc(0xe3)]=_0x349ebc(0x132)+Math[_0x349ebc(0x107)]()*0.2+')',_0x3a0608['beginPath'](),_0x3a0608[_0x349ebc(0xdd)](Math['random']()*0x32,Math[_0x349ebc(0x107)]()*0x32,Math[_0x349ebc(0x107)]()*0x2,0x0,Math['PI']*0x2),_0x3a0608[_0x349ebc(0x10e)]();}_0x37fc00['update'](),_0x5d6e41(_0x37fc00);}});};color4Image[_0x53b1a4(0x140)]=_0x53b1a4(0x148);const _0x21fb03=document[_0x53b1a4(0xfc)](_0x53b1a4(0x10f));_0x21fb03[_0x53b1a4(0xe5)](_0x53b1a4(0x13c),function(_0x3e9e9e){const _0x3ff62d=_0x53b1a4,_0x2c2990=_0x3e9e9e[_0x3ff62d(0x149)][_0x3ff62d(0xf6)][0x0];if(_0x2c2990){const _0x390f9c=new FileReader();_0x390f9c[_0x3ff62d(0x172)]=function(_0x5f17bb){const _0x4d753c=_0x3ff62d;laimagneesCombiandases(_0x5f17bb[_0x4d753c(0x149)][_0x4d753c(0x108)],_0x4d753c(0x147));},_0x390f9c[_0x3ff62d(0x12e)](_0x2c2990);}});let _0x449a11=_0x53b1a4(0x126);const _0x5f2a4f=function(_0x536cc1){const _0x2d207d=_0x53b1a4,_0x4f282a=_0x537551[_0x2d207d(0x16a)](_0x537551[_0x2d207d(0xf1)],_0x537551[_0x2d207d(0x113)]);if(_0x4f282a['hit']&&!![]){const _0x56e23=_0x4f282a[_0x2d207d(0xec)]();if(_0x56e23){const _0x215f45=Math[_0x2d207d(0x118)](_0x56e23['x']*_0x4dd466),_0x1fed3f=Math[_0x2d207d(0x118)]((0x1-_0x56e23['y'])*_0x4dd466);if(brushTextures[_0x449a11]){const _0xd8c5b9=brushTextures[_0x449a11][_0x2d207d(0xf9)]()[_0x2d207d(0xff)],_0x777222=brushTextures[_0x449a11][_0x2d207d(0xf9)]()[_0x2d207d(0x135)](0x0,0x0,0x32,0x32),_0x204d2a=_0x243e6d[_0x2d207d(0x135)](_0x215f45-brushSize/0x2,_0x1fed3f-brushSize/0x2,brushSize,brushSize),_0x4917e2=brushSize/0x2,_0x459bc9=brushSize/0x2,_0x37728a=brushRotation*Math['PI']/0xb4;for(let _0x2ed298=0x0;_0x2ed298<_0x204d2a['data'][_0x2d207d(0xf5)];_0x2ed298+=0x4){const _0x5d74e9=_0x2ed298/0x4%brushSize,_0x5f1dc4=Math[_0x2d207d(0x118)](_0x2ed298/0x4/brushSize),_0x3140c0=Math[_0x2d207d(0x157)](_0x37728a)*(_0x5d74e9-_0x4917e2)-Math[_0x2d207d(0x167)](_0x37728a)*(_0x5f1dc4-_0x459bc9)+_0x4917e2,_0x4f94a2=Math['sin'](_0x37728a)*(_0x5d74e9-_0x4917e2)+Math[_0x2d207d(0x157)](_0x37728a)*(_0x5f1dc4-_0x459bc9)+_0x459bc9,_0x3e64e2=Math[_0x2d207d(0x118)](_0x3140c0*(0x32/brushSize)),_0x49ed08=Math[_0x2d207d(0x118)](_0x4f94a2*(0x32/brushSize));if(_0x3e64e2>=0x0&&_0x3e64e2<0x32&&_0x49ed08>=0x0&&_0x49ed08<0x32){const _0x2023b3=(_0x49ed08*0x32+_0x3e64e2)*0x4,_0x1d4b6b=_0x777222[_0x2d207d(0x13e)][_0x2023b3+0x3]/0xff;_0x204d2a[_0x2d207d(0x13e)][_0x2ed298]=_0x777222[_0x2d207d(0x13e)][_0x2023b3]*_0x1d4b6b+_0x204d2a[_0x2d207d(0x13e)][_0x2ed298]*(0x1-_0x1d4b6b),_0x204d2a[_0x2d207d(0x13e)][_0x2ed298+0x1]=_0x777222[_0x2d207d(0x13e)][_0x2023b3+0x1]*_0x1d4b6b+_0x204d2a[_0x2d207d(0x13e)][_0x2ed298+0x1]*(0x1-_0x1d4b6b),_0x204d2a[_0x2d207d(0x13e)][_0x2ed298+0x2]=_0x777222[_0x2d207d(0x13e)][_0x2023b3+0x2]*_0x1d4b6b+_0x204d2a['data'][_0x2ed298+0x2]*(0x1-_0x1d4b6b);}}_0x243e6d[_0x2d207d(0x158)](_0x204d2a,_0x215f45-brushSize/0x2,_0x1fed3f-brushSize/0x2),_0x2a260e[_0x2d207d(0xfa)]();}}}},_0x3837fd=function(_0x10809c){const _0x4553ee=_0x53b1a4,_0x53fddc=_0x537551['pick'](_0x537551['pointerX'],_0x537551[_0x4553ee(0x113)]);if(_0x53fddc[_0x4553ee(0x12a)]){const _0x4d9fb=_0x53fddc[_0x4553ee(0xe6)],_0x33fb2c=_0x53fddc[_0x4553ee(0xe2)],_0x9b6eb7=_0x1e9e6c(_0x4d9fb,_0x33fb2c);if(_0x9b6eb7){const _0x37b6a2=Math[_0x4553ee(0x118)](_0x9b6eb7['x']*_0x4dd466),_0x593ff9=Math[_0x4553ee(0x118)]((0x1-_0x9b6eb7['y'])*_0x4dd466);if(brushTextures[_0x449a11]){const _0x310deb=brushTextures[_0x449a11][_0x4553ee(0xf9)]()['getImageData'](0x0,0x0,0x32,0x32),_0x547fdb=_0x243e6d[_0x4553ee(0x135)](_0x37b6a2-brushSize/0x2,_0x593ff9-brushSize/0x2,brushSize,brushSize);for(let _0x33af85=0x0;_0x33af85<_0x547fdb['data'][_0x4553ee(0xf5)];_0x33af85+=0x4){const _0x5845d6=_0x33af85/0x4%brushSize,_0x100a6d=Math[_0x4553ee(0x118)](_0x33af85/0x4/brushSize),_0x554c66=Math[_0x4553ee(0x157)](brushRotation*Math['PI']/0xb4)*(_0x5845d6-brushSize/0x2)-Math[_0x4553ee(0x167)](brushRotation*Math['PI']/0xb4)*(_0x100a6d-brushSize/0x2)+brushSize/0x2,_0x1a2a92=Math[_0x4553ee(0x167)](brushRotation*Math['PI']/0xb4)*(_0x5845d6-brushSize/0x2)+Math[_0x4553ee(0x157)](brushRotation*Math['PI']/0xb4)*(_0x100a6d-brushSize/0x2)+brushSize/0x2,_0x5670b4=Math[_0x4553ee(0x118)](_0x554c66*(0x32/brushSize)),_0x421e03=Math[_0x4553ee(0x118)](_0x1a2a92*(0x32/brushSize));if(_0x5670b4>=0x0&&_0x5670b4<0x32&&_0x421e03>=0x0&&_0x421e03<0x32){const _0x477eec=(_0x421e03*0x32+_0x5670b4)*0x4,_0x554903=_0x310deb[_0x4553ee(0x13e)][_0x477eec+0x3]/0xff;_0x547fdb['data'][_0x33af85]=_0x310deb[_0x4553ee(0x13e)][_0x477eec]*_0x554903+_0x547fdb['data'][_0x33af85]*(0x1-_0x554903),_0x547fdb[_0x4553ee(0x13e)][_0x33af85+0x1]=_0x310deb[_0x4553ee(0x13e)][_0x477eec+0x1]*_0x554903+_0x547fdb['data'][_0x33af85+0x1]*(0x1-_0x554903),_0x547fdb[_0x4553ee(0x13e)][_0x33af85+0x2]=_0x310deb[_0x4553ee(0x13e)][_0x477eec+0x2]*_0x554903+_0x547fdb[_0x4553ee(0x13e)][_0x33af85+0x2]*(0x1-_0x554903);}}_0x243e6d[_0x4553ee(0x158)](_0x547fdb,_0x37b6a2-brushSize/0x2,_0x593ff9-brushSize/0x2),_0x2a260e[_0x4553ee(0xfa)]();}}}};function _0x1e9e6c(_0xc7a4d8,_0x21384d){const _0x5d35bf=_0x53b1a4,_0x48f3f8=_0x21384d['getVerticesData'](BABYLON['VertexBuffer'][_0x5d35bf(0x100)]),_0x511872=_0x21384d['getVerticesData'](BABYLON['VertexBuffer'][_0x5d35bf(0x166)]),_0x5bdffa=_0x21384d['getIndices']();if(_0x48f3f8&&_0x511872&&_0x5bdffa){const _0x467802=_0x5bdffa[_0x5d35bf(0xf5)];let _0xf0f663=null,_0x4da3f9=Number[_0x5d35bf(0xee)];for(let _0xcecbff=0x0;_0xcecbff<_0x467802;_0xcecbff+=0x3){const _0x53ad54=_0x5bdffa[_0xcecbff],_0x2ba365=_0x5bdffa[_0xcecbff+0x1],_0x2635ca=_0x5bdffa[_0xcecbff+0x2],_0xf53837=BABYLON['Vector3'][_0x5d35bf(0x137)](_0x48f3f8,_0x53ad54*0x3),_0x26f77d=BABYLON[_0x5d35bf(0x12d)][_0x5d35bf(0x137)](_0x48f3f8,_0x2ba365*0x3),_0xf0ae46=BABYLON[_0x5d35bf(0x12d)]['FromArray'](_0x48f3f8,_0x2635ca*0x3),_0x4bb179=_0x511872[_0x53ad54*0x2],_0x3df5da=_0x511872[_0x53ad54*0x2+0x1],_0x224502=_0x511872[_0x2ba365*0x2],_0x2c6491=_0x511872[_0x2ba365*0x2+0x1],_0x1e0d87=_0x511872[_0x2635ca*0x2],_0x26dd89=_0x511872[_0x2635ca*0x2+0x1],_0x21001a=_0x22bcbe(_0xc7a4d8,_0xf53837,_0x26f77d,_0xf0ae46);if(_0x21001a){const _0x4083f7={'x':_0x21001a['x']*_0x4bb179+_0x21001a['y']*_0x224502+_0x21001a['z']*_0x1e0d87,'y':_0x21001a['x']*_0x3df5da+_0x21001a['y']*_0x2c6491+_0x21001a['z']*_0x26dd89};return _0x4083f7;}}}return{'x':0x0,'y':0x0};}function _0x22bcbe(_0x2bba61,_0x25a174,_0x274429,_0x34a0fa){const _0x1f6590=_0x53b1a4,_0x20e6c7=_0x274429[_0x1f6590(0x153)](_0x25a174),_0x424478=_0x34a0fa['subtract'](_0x25a174),_0x4a78ba=_0x2bba61[_0x1f6590(0x153)](_0x25a174),_0x2817f3=BABYLON[_0x1f6590(0x12d)][_0x1f6590(0x152)](_0x20e6c7,_0x20e6c7),_0x554619=BABYLON[_0x1f6590(0x12d)][_0x1f6590(0x152)](_0x20e6c7,_0x424478),_0x2dc2ed=BABYLON[_0x1f6590(0x12d)][_0x1f6590(0x152)](_0x20e6c7,_0x4a78ba),_0x4a6114=BABYLON['Vector3'][_0x1f6590(0x152)](_0x424478,_0x424478),_0x4cdbfe=BABYLON[_0x1f6590(0x12d)][_0x1f6590(0x152)](_0x424478,_0x4a78ba),_0x4698a0=0x1/(_0x2817f3*_0x4a6114-_0x554619*_0x554619),_0x52360f=(_0x4a6114*_0x2dc2ed-_0x554619*_0x4cdbfe)*_0x4698a0,_0x73d22b=(_0x2817f3*_0x4cdbfe-_0x554619*_0x2dc2ed)*_0x4698a0;return{'x':_0x52360f,'y':_0x73d22b,'z':0x1-_0x52360f-_0x73d22b};}_0x537551['onPointerObservable'][_0x53b1a4(0x11a)](_0x151a5f=>{_0x151a5f['type']===BABYLON['PointerEventTypes']['POINTERDOWN']&&_0x5f2a4f(_0x151a5f);});const _0x1dc189=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x17c)][_0x53b1a4(0x103)]('UI'),_0x4ee8ef=function(_0x4ae552,_0x2ddcbb,_0x315471){const _0x4fb6a3=_0x53b1a4;console[_0x4fb6a3(0x14c)](_0x4ae552,_0x2ddcbb,_0x315471);const _0x169d39=BABYLON[_0x4fb6a3(0xef)][_0x4fb6a3(0x115)][_0x4fb6a3(0x12f)](_0x4fb6a3(0x110)+_0x4ae552,_0x4ae552);_0x169d39[_0x4fb6a3(0x124)]='100px',_0x169d39[_0x4fb6a3(0x159)]=_0x4fb6a3(0x139),_0x169d39[_0x4fb6a3(0x136)]=_0x4fb6a3(0x128),_0x169d39['background']=_0x2ddcbb,_0x169d39['horizontalAlignment']=BABYLON[_0x4fb6a3(0xef)]['Control'][_0x4fb6a3(0x177)],_0x169d39[_0x4fb6a3(0xe4)]=BABYLON['GUI'][_0x4fb6a3(0x142)][_0x4fb6a3(0x17a)],_0x169d39[_0x4fb6a3(0x145)]=_0x315471,_0x169d39[_0x4fb6a3(0xdf)]='-10px',_0x169d39[_0x4fb6a3(0x12b)][_0x4fb6a3(0x11a)](function(){const _0x8c29ff=_0x4fb6a3;_0x449a11=_0x8c29ff(0x136)+_0x4ae552[_0x8c29ff(0x155)](-0x1),console[_0x8c29ff(0x14c)](_0x449a11,_0x8c29ff(0xf0));}),_0x1dc189[_0x4fb6a3(0x16e)](_0x169d39);};_0x4ee8ef(_0x53b1a4(0x13f),_0x53b1a4(0x131),_0x53b1a4(0x106)),_0x449a11='color4';const _0x22385b=new BABYLON['GUI'][(_0x53b1a4(0x104))]();_0x22385b['minimum']=0x0,_0x22385b['maximum']=0x3e8,_0x22385b[_0x53b1a4(0x13a)]=0x12c,_0x22385b[_0x53b1a4(0x159)]=_0x53b1a4(0x138),_0x22385b[_0x53b1a4(0x124)]='200px',_0x22385b[_0x53b1a4(0x143)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)]['HORIZONTAL_ALIGNMENT_LEFT'],_0x22385b['verticalAlignment']=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)][_0x53b1a4(0x17a)],_0x22385b[_0x53b1a4(0x145)]=_0x53b1a4(0x106),_0x22385b[_0x53b1a4(0xdf)]=_0x53b1a4(0x13b),_0x22385b[_0x53b1a4(0xfe)][_0x53b1a4(0x11a)](function(_0x35e0d4){brushSize=_0x35e0d4;}),_0x1dc189['addControl'](_0x22385b);const _0x2b07e1=new BABYLON[(_0x53b1a4(0xef))][(_0x53b1a4(0x10c))]();_0x2b07e1['text']=_0x53b1a4(0x16d),_0x2b07e1[_0x53b1a4(0x159)]=_0x53b1a4(0x138),_0x2b07e1[_0x53b1a4(0x136)]=_0x53b1a4(0x128),_0x2b07e1['horizontalAlignment']=BABYLON['GUI'][_0x53b1a4(0x142)]['HORIZONTAL_ALIGNMENT_LEFT'],_0x2b07e1[_0x53b1a4(0xe4)]=BABYLON['GUI'][_0x53b1a4(0x142)][_0x53b1a4(0x17a)],_0x2b07e1[_0x53b1a4(0x145)]=_0x53b1a4(0xde),_0x2b07e1['top']=_0x53b1a4(0x13b),_0x1dc189[_0x53b1a4(0x16e)](_0x2b07e1),_0x22385b[_0x53b1a4(0xfe)][_0x53b1a4(0x11a)](function(_0x2734f4){const _0x1fd313=_0x53b1a4;brushSize=_0x2734f4,_0x2b07e1[_0x1fd313(0x175)]=_0x1fd313(0x123)+Math[_0x1fd313(0x134)](_0x2734f4);});const _0x27218d=new BABYLON[(_0x53b1a4(0xef))][(_0x53b1a4(0x127))]();_0x27218d[_0x53b1a4(0x124)]=_0x53b1a4(0x138),_0x27218d['height']=_0x53b1a4(0x138),_0x27218d[_0x53b1a4(0x15d)]=![],_0x27218d[_0x53b1a4(0x143)]=BABYLON['GUI'][_0x53b1a4(0x142)]['HORIZONTAL_ALIGNMENT_LEFT'],_0x27218d[_0x53b1a4(0xe4)]=BABYLON['GUI'][_0x53b1a4(0x142)][_0x53b1a4(0x17a)],_0x27218d[_0x53b1a4(0x145)]=_0x53b1a4(0x106),_0x27218d[_0x53b1a4(0xdf)]=_0x53b1a4(0x12c),_0x27218d['onIsCheckedChangedObservable'][_0x53b1a4(0x11a)](function(_0x122f02){const _0x316a4a=_0x53b1a4;isRotationLocked=_0x122f02,_0x3bf1e1[_0x316a4a(0x144)](canvas),!_0x122f02&&_0x3bf1e1[_0x316a4a(0x11d)](canvas,!![]);}),_0x1dc189['addControl'](_0x27218d);const _0x353fdc=new BABYLON['GUI'][(_0x53b1a4(0x10c))]();_0x353fdc[_0x53b1a4(0x175)]=_0x53b1a4(0x121),_0x353fdc['height']=_0x53b1a4(0x138),_0x353fdc['color']=_0x53b1a4(0x128),_0x353fdc[_0x53b1a4(0x143)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)][_0x53b1a4(0x177)],_0x353fdc[_0x53b1a4(0xe4)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)]['VERTICAL_ALIGNMENT_BOTTOM'],_0x353fdc[_0x53b1a4(0x145)]='40px',_0x353fdc[_0x53b1a4(0xdf)]='-90px',_0x1dc189[_0x53b1a4(0x16e)](_0x353fdc);const _0xe69e5f=new BABYLON[(_0x53b1a4(0xef))][(_0x53b1a4(0x104))]();_0xe69e5f['minimum']=0x0,_0xe69e5f['maximum']=0x168,_0xe69e5f[_0x53b1a4(0x13a)]=0x0,_0xe69e5f['height']=_0x53b1a4(0x138),_0xe69e5f['width']=_0x53b1a4(0x179),_0xe69e5f[_0x53b1a4(0x143)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)]['HORIZONTAL_ALIGNMENT_LEFT'],_0xe69e5f[_0x53b1a4(0xe4)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)][_0x53b1a4(0x17a)],_0xe69e5f[_0x53b1a4(0x145)]=_0x53b1a4(0x106),_0xe69e5f[_0x53b1a4(0xdf)]='-120px',_0xe69e5f[_0x53b1a4(0xfe)][_0x53b1a4(0x11a)](function(_0x4b11c8){brushRotation=_0x4b11c8;}),_0x1dc189['addControl'](_0xe69e5f);const _0x33fed6=new BABYLON[(_0x53b1a4(0xef))][(_0x53b1a4(0x10c))]();_0x33fed6[_0x53b1a4(0x175)]=_0x53b1a4(0x170),_0x33fed6[_0x53b1a4(0x159)]=_0x53b1a4(0x138),_0x33fed6[_0x53b1a4(0x136)]=_0x53b1a4(0x128),_0x33fed6[_0x53b1a4(0x143)]=BABYLON['GUI'][_0x53b1a4(0x142)]['HORIZONTAL_ALIGNMENT_LEFT'],_0x33fed6[_0x53b1a4(0xe4)]=BABYLON[_0x53b1a4(0xef)][_0x53b1a4(0x142)][_0x53b1a4(0x17a)],_0x33fed6['left']='220px',_0x33fed6['top']=_0x53b1a4(0x14e),_0x1dc189[_0x53b1a4(0x16e)](_0x33fed6),_0xe69e5f[_0x53b1a4(0xfe)][_0x53b1a4(0x11a)](function(_0x86c70e){const _0x3ce6b9=_0x53b1a4;brushRotation=_0x86c70e,_0x33fed6[_0x3ce6b9(0x175)]=_0x3ce6b9(0x141)+Math[_0x3ce6b9(0x134)](_0x86c70e)+'°';});function _0x147c48(_0x2c043a,_0x2deaa3){const _0x142c3c=_0x53b1a4,_0x4441e8=new BABYLON['PBRMaterial'](_0x142c3c(0xfd),_0x2c043a);return _0x4441e8[_0x142c3c(0xe9)]=_0x2a260e[_0x142c3c(0x16b)](),_0x4441e8[_0x142c3c(0xea)]=0.5,_0x4441e8[_0x142c3c(0xf7)]=0.5,_0x4441e8;}function _0x31ec61(_0x5c268a){const _0x109cae=_0x53b1a4,_0x4fee37=_0x5c268a[_0x109cae(0x15f)](BABYLON[_0x109cae(0x117)]['UVKind']);if(!_0x4fee37){console[_0x109cae(0x162)](_0x109cae(0x17b));return;}let _0x3f9146=Number[_0x109cae(0xee)],_0x46bf08=-Number['MAX_VALUE'],_0x275ad2=Number[_0x109cae(0xee)],_0x2643e1=-Number[_0x109cae(0xee)];for(let _0x125b10=0x0;_0x125b10<_0x4fee37[_0x109cae(0xf5)];_0x125b10+=0x2){const _0x2f0c02=_0x4fee37[_0x125b10],_0xa152b2=_0x4fee37[_0x125b10+0x1];if(_0x2f0c02<_0x3f9146)_0x3f9146=_0x2f0c02;if(_0x2f0c02>_0x46bf08)_0x46bf08=_0x2f0c02;if(_0xa152b2<_0x275ad2)_0x275ad2=_0xa152b2;if(_0xa152b2>_0x2643e1)_0x2643e1=_0xa152b2;}const _0x5930a0=_0x46bf08-_0x3f9146,_0x50dfa3=_0x2643e1-_0x275ad2;console[_0x109cae(0x14c)](_0x109cae(0x173)+_0x5930a0+_0x109cae(0x169)+_0x50dfa3);const _0x3f21e9=_0x4fee37[_0x109cae(0x176)]((_0x5c9326,_0x17545d)=>{return _0x17545d%0x2===0x0?(_0x5c9326-_0x3f9146)/_0x5930a0:(_0x5c9326-_0x275ad2)/_0x50dfa3;});_0x5c268a[_0x109cae(0x163)](BABYLON[_0x109cae(0x117)][_0x109cae(0x166)],_0x3f21e9),console[_0x109cae(0x14c)](_0x109cae(0x10a));}_0x537551[_0x53b1a4(0x160)](!![],!![],!![]);let _0x3bf1e1=null;const _0x726773=0x400,_0x1fd3b5=new BABYLON[(_0x53b1a4(0x164))](_0x53b1a4(0x105),{'width':_0x4dd466,'height':_0x4dd466},_0x537551),_0x113001=_0x2a260e[_0x53b1a4(0xf9)](),_0x261dac=document['getElementById'](_0x53b1a4(0x10d));var _0x36ff10=async _0x503ce5=>{const _0x157d4c=_0x53b1a4;_0x537551[_0x157d4c(0x14a)][_0x157d4c(0x119)](_0x50a4ef=>{const _0x5e6e1d=_0x157d4c;_0x50a4ef[_0x5e6e1d(0x165)]!==_0x5e6e1d(0xf3)&&_0x50a4ef[_0x5e6e1d(0xe1)]();}),_0x537551[_0x157d4c(0x150)]['forEach'](_0x32451b=>{const _0x3b497f=_0x157d4c;_0x32451b[_0x3b497f(0x165)]!==_0x3b497f(0x154)&&_0x32451b[_0x3b497f(0xe1)]();}),await BABYLON[_0x157d4c(0xe0)][_0x157d4c(0x15c)](_0x503ce5,'',_0x537551);const _0x2600a7=new Image();_0x2600a7[_0x157d4c(0x140)]='b1.png',_0x2600a7[_0x157d4c(0x172)]=()=>{const _0x1ce436=_0x157d4c;let _0x2af746=new BABYLON[(_0x1ce436(0x164))]('dynamicTexture',{'width':0x400,'height':0x400},_0x537551,![]),_0xbb092=_0x2af746[_0x1ce436(0xf9)]();_0xbb092['drawImage'](_0x2600a7,0x0,0x0,0x400,0x400),_0x2af746[_0x1ce436(0xfa)](),_0x4dd466=0x400,_0x2a260e=new BABYLON[(_0x1ce436(0x164))](_0x1ce436(0x105),{'width':_0x4dd466,'height':_0x4dd466},_0x537551),_0x243e6d=_0x2a260e[_0x1ce436(0xf9)](),_0x243e6d[_0x1ce436(0xe3)]=_0x1ce436(0x128),_0x243e6d['fillRect'](0x0,0x0,_0x4dd466,_0x4dd466),_0x2a260e[_0x1ce436(0xfa)](),_0x3fa2d9=new BABYLON[(_0x1ce436(0x156))](_0x1ce436(0x101),_0x537551),_0x3fa2d9['diffuseTexture']=_0x2a260e;let _0xd607ae=new BABYLON[(_0x1ce436(0x174))](_0x1ce436(0xfd),_0x537551);_0xd607ae[_0x1ce436(0xe9)]=_0x2af746,_0xd607ae['metallic']=0.7,_0xd607ae[_0x1ce436(0xf7)]=0.2,_0x537551[_0x1ce436(0x14a)]['forEach'](_0x40f7ea=>{const _0x25c53c=_0x1ce436;_0x40f7ea['name']!==_0x25c53c(0xf3)&&(_0x40f7ea[_0x25c53c(0x109)]=_0x3fa2d9,_0x31ec61(_0x40f7ea));});};};return _0x261dac[_0x53b1a4(0x11c)]=_0x53b1a4(0x125),_0x261dac[_0x53b1a4(0x146)]=_0x53b1a4(0x15b),_0x261dac[_0x53b1a4(0xe5)](_0x53b1a4(0x13c),async _0x390957=>{const _0x5f5da3=_0x53b1a4;if(_0x390957[_0x5f5da3(0x149)][_0x5f5da3(0xf6)]&&_0x390957['target'][_0x5f5da3(0xf6)][0x0]){const _0x4af3a7=new FileReader();_0x4af3a7['onload']=_0x5bfbd8=>{const _0x2a0af8=_0x5f5da3;_0x36ff10(_0x5bfbd8[_0x2a0af8(0x149)][_0x2a0af8(0x108)],_0x537551);},_0x4af3a7['readAsDataURL'](_0x390957[_0x5f5da3(0x149)][_0x5f5da3(0xf6)][0x0]);}}),_0x537551;}}createScene=function(){const _0x45191a=_0x15bb99;return Playground[_0x45191a(0xeb)](engine,engine[_0x45191a(0x130)]());},window[_0x15bb99(0xe8)]=async function(){const _0x1ca8df=_0x15bb99;var _0x2f12f0=async function(){const _0x381224=_0x530a;try{return createDefaultEngine();}catch(_0x5124ca){return console[_0x381224(0x14c)](_0x381224(0xfb)),createDefaultEngine();}};window['engine']=await _0x2f12f0();if(!engine)throw _0x1ca8df(0x168);startRenderLoop(engine,canvas),window[_0x1ca8df(0x11b)]=createScene();},initFunction()[_0x15bb99(0x11e)](()=>{const _0xfcf34b=_0x15bb99;scene[_0xfcf34b(0x11e)](_0x2e4d9e=>{sceneToRender=_0x2e4d9e;});}),window[_0x15bb99(0xe5)](_0x15bb99(0xf8),function(){const _0x3731d8=_0x15bb99;engine[_0x3731d8(0xf8)]();});
    </script>
  </body>
</html>
